ВАРИАНТ 15

При проведении  шахматных соревнований возникает проблема подсчёта рейтинга игроков. В данной задаче правила игры в шахматы значительно изменены. Игра ведется произвольным количеством игроков. В процессе игры каждый из игроков должен выполнить фиксированное множество заданий, которые обозначаются заглавными латинскими буквами A-Z (таким образом, максимальное количество заданий равно 26). Для выполнения задания игрок делает «ход», который может быть как успешным, так и неудачным. Если ход был успешным, игрок за него получает штрафной балл, равный количеству минут, прошедших от начала игры до момента совершения этого хода, плюс по 20 штрафных баллов за каждый предыдущий неудачный ход по данному заданию. Последующие ходы по уже выполненному заданию игнорируются. Штрафной балл игрока вычисляется суммированием штрафных баллов по всем выполненным заданиям, при этом невыполненные задания вклад в штрафной балл не дают. Участники ранжируются в порядке убывания количества выполненных заданий. Участники с одинаковым количеством выполненных заданий ранжируются в порядке возрастания количества штрафных баллов. Участники с одинаковым количеством выполненных заданий и с одинаковым количеством штрафных баллов ранжируются по алфавиту, причём они занимают один интервал мест.
По заданной записи игры в некоторый момент времени требуется вычислить и напечатать положение участников по состоянию на этот момент.

Входные данные

В первой строке входного файла задаётся целое число N (1 <= N <= 100000) – количество записей во входном файле и максимальная буква задания P (А <= Р <= Z). Далее следуют записи о ходах, причём каждая запись располагается на отдельной строке текста. Во входном файле отсутствуют пустые строки. Каждая запись имеет следующий вид:

Время Игрок Задание Результат

Ниже приводится расшифровка условных обозначений:
•	Время - количество секунд, прошедших от начала игры до данного хода. Записи упорядочены по времени в порядке возрастания. При переводе секунд в минуты при вычислении штрафа происходит отбрасывание неполных минут.
•	Игрок - псевдоним игрока, который представляет собой непустую последовательность строчных латинских букв и цифр.
•	Задание - заглавная латинская буква от А до максимальной буквы задания Р включительно. 
•	Результат - строка ОК, если задание было принято, и строка FAILED, если задание не было принято. 

Элементы записи отделяются друг от друга одним пробелом. Игра не может длиться более чем 64 земных года, в игре не могут принимать участие более чем 1024 участника, длина каждой записи о ходе не превышает 255 символов.

Выходные данные

В выходном файле напечатать таблицу текущего положения игроков. Таблица печатается без заголовка и состоит из K строк текста, где K - это количество участников игры. Каждая строка таблицы состоит из пяти элементов вывода и имеет следующий вид: 

Место Игрок Результаты Задачи Штраф

Ниже приводится расшифровка условных обозначений:
•	Место - одно место или диапазон мест, которые занимает участник. Если участник ни с кем не делит место, поле Место представляет собой целое число. Если участник делит места с f по t с другими участниками (то есть решил, столько же заданий и получил такой же штрафной балл), поле Место должно состоять из двух целых чисел f и t (f и t целые числа и f < t), разделённых знаком «-» (минус). Никакие символы, отделяющие знак минус от целых чисел не допускаются. 
•	Игрок - псевдоним участника. При разделении мест между несколькими участниками строки таблицы упорядочиваются в лексикографическом порядке псевдонимов участников.
•	Задачи - общее количество решённых заданий, то есть целое число.
•	Штраф - штраф, начисленный за решённые задания, также целое число.
•	Результаты - сводка результатов решения заданий данным участником. Сводка состоит из информации о решении всех заданий от А до Р. Для игрока g и задания p, должна быть напечатана общая статистика выполнения участником данного задания. Возможны следующие варианты:

.	«.» (точка) по данному заданию данным участником не было сделано ни одной попытки.
-k	было сделано k неудачных попыток.
+(h:mm)	задание было успешно выполнено с первой попытки через h часов и mm минут после начала турнира.
+k(h:mm)	задание было выполнено успешно после k неудачных попыток, при этом первая успешная попытка была выполнена через h часов и mm минут после начала игры.

Элементы вывода отделяются друг от друга одним пробелом. Пробельные символы в элементах вывода не допускаются. 

Пример входных данных (файл table.in)

4 А
19 ezhiki А ОК
20 rybki А FAILED
174 pti4ki А ОК
183 elfy А FAILED

Соответствующие выходные данные (файл table.out)

1 ezhiki +(0:00) 1 0
2 pti4ki +(0:02) 1 2
3-4 еlfу -1 0 0
3-4 rybki -1 0 0
